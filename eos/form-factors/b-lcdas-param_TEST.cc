/* vim: set sw=4 sts=4 et foldmethod=syntax : */

/*
 * Copyright (c) 2022 Danny van Dyk
 * Copyright (c) 2022 Philip LÃ¼ghausen
 *
 * This file is part of the EOS project. EOS is free software;
 * you can redistribute it and/or modify it under the terms of the GNU General
 * Public License version 2, as published by the Free Software Foundation.
 *
 * EOS is distributed in the hope that it will be useful, but WITHOUT ANY
 * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more
 * details.
 *
 * You should have received a copy of the GNU General Public License along with
 * this program; if not, write to the Free Software Foundation, Inc., 59 Temple
 * Place, Suite 330, Boston, MA  02111-1307  USA
 */

#include <test/test.hh>
#include <eos/form-factors/b-lcdas-param.hh>

using namespace test;
using namespace eos;
using namespace b_lcdas;
using namespace aux;

class ParamTest :
    public TestCase
{
    public:
        ParamTest() :
            TestCase("b_lcdas_param_test")
        {
        }

        virtual void run() const
        {
            // Mathmatical functions
            {
                static const double eps = 1e-7;
                TEST_CHECK_NEARLY_EQUAL(L0_phi_plus(6.0780670684337, {2.76535558086303, 4.4418212641382, 3.34355542555607, 0.938534694199976, 0.837430012672025, -2.47112057544783, 3.48553635051652, 4.23623508480623, -4.8032561356037}), 0.66001224638482, eps);
                TEST_CHECK_NEARLY_EQUAL(L0_phi_plus(0.95592103061157, {-4.94439148782546, 2.91110196877919, -4.29307834972199, 0.220795366805618, 0.794038482970978, 1.64242255145276, 3.87501603470439, 3.37994848750093, 1.80204704560958}), -5.71470714051745, eps);
                TEST_CHECK_NEARLY_EQUAL(L0_phi_plus(1.2123309803416, {-0.520930352224784, 3.93413347785451, 4.34415734422757, 0.166394677015111, 4.29662792754847, -0.237721418500518, -2.16327942537549, 2.69358071054554, 2.43178473080335}), 1.44152553658808, eps);
                TEST_CHECK_NEARLY_EQUAL(L0_phi_plus(6.10415832192266, {4.83224058870368, -0.476300692151913, 2.743965953601, 3.66344675650984, -4.82078357900998, -4.57485844556256, -3.10680840290197, -4.72472951141496, -4.57657528225914}), 0.627506832019762, eps);
                TEST_CHECK_NEARLY_EQUAL(L0_phi_plus(7.40320012577378, {0.615013769053634, 3.32619170112516, -1.49221238950388, 3.36063259731878, -0.921094502092197, -3.45184816501907, 2.05977929945726, -2.68919344060002, 2.0626858990247}), 0.0617073917853985, eps);
                TEST_CHECK_NEARLY_EQUAL(L0_phi_plus(0.336184392187096, {4.11951118372871, -0.605351016154469, 4.01330960179262, 3.73350954351392, 1.78681247755128, 2.67558953040928, 4.75622993418832, -3.87490077107116, -3.16661873721025}), 18.2705044673728, eps);

                TEST_CHECK_NEARLY_EQUAL(L0inc_phi_plus(1.67945604153449, 3.99615960932302, {2.80467091812212, 2.81534825672545, 4.70150927240008, 2.54544202165289, -3.55732902075698, 0.377046745429317, -4.56195747945128, -2.38606324955398, 0.46510806315802}), 0.557451537959998, eps);
                TEST_CHECK_NEARLY_EQUAL(L0inc_phi_plus(7.85443342578708, 3.05238196756568, {1.99471002179489, -0.968286492377112, 2.06156665340006, -0.454119345496206, -3.05060664049595, -4.5050096614697, -2.77595554664895, 4.85721102882916, 1.33455613229912}), 0.345004851183816, eps);
                TEST_CHECK_NEARLY_EQUAL(L0inc_phi_plus(4.89769436688287, 1.74546647345788, {0.230610894596628, -0.73381142445073, 4.20149270464992, -1.86748084480963, 3.84687317515142, 0.123021358702049, -2.71611522575227, 1.46809102987606, -2.78476621189425}), 0.330725145719686, eps);
                TEST_CHECK_NEARLY_EQUAL(L0inc_phi_plus(7.51267960356043, 2.71519934291773, {0.31597271952891, 1.10854519987269, -1.57120033086599, -4.74915152219122, 3.60400710965273, 1.44890522029927, 3.88466417199422, 0.31364997190035, 4.24921908393025}), 0.273295997158988, eps);
                TEST_CHECK_NEARLY_EQUAL(L0inc_phi_plus(1.41112691286552, 6.07490020195162, {4.30231000805123, -1.27420424941171, 0.725154704930951, -4.97890466521687, 0.685030438685674, 1.84178309504184, -3.37985571143957, -3.48781046988581, 2.89553278321765}), -0.0112631537197419, eps);
                TEST_CHECK_NEARLY_EQUAL(L0inc_phi_plus(3.15306433401325, 0.957109080761084, {-4.48653115911879, -0.787898533067526, 0.792489262011957, 1.98193604792094, -2.85172908820336, 2.6067147576532, -4.12525209269038, -3.41725438521731, -0.490568370387559}), -4.76634305920753, eps);

                TEST_CHECK_NEARLY_EQUAL(B_phi_plus(0.658122256890007, 8.74771791972663, 2.77336096259717, {-1.39382273730714, -1.30607026030103, 2.60688402285192, -4.32526530484555, 0.68472001465385, -0.420625404884961, -4.9827009213667, -3.16645903945008, -1.76084861799042}), -0.0144888134959701, eps);
                TEST_CHECK_NEARLY_EQUAL(B_phi_plus(3.68042532024325, 4.79705419327097, 4.42478489384342, {-2.86829529060832, -1.4634364356507, -4.07903050820879, 4.95410369583789, -0.441891354816388, 4.48694380565424, -4.71964186360014, 4.45117093851861, -3.84911152995793}), -0.00716126062105567, eps);
                TEST_CHECK_NEARLY_EQUAL(B_phi_plus(1.11376148814179, 2.84796164275945, 2.98648386326524, {1.89148285033056, 3.82897788473128, -0.362100212247047, 2.59095551445086, -3.54171334599771, -4.44594237155531, 4.55832518910787, -4.12146232923858, -4.9904037381737}), 0.0228835834936011, eps);
                TEST_CHECK_NEARLY_EQUAL(B_phi_plus(7.48346064614231, 6.19229483220491, 4.50726011471824, {-3.7496659717414, -3.57988966974479, -2.73987477786637, -3.56137238406956, -3.14925473688247, -4.09554876007929, 3.56088334336432, -3.71954496505854, 4.11055663869957}), -0.0181541340111304, eps);
                TEST_CHECK_NEARLY_EQUAL(B_phi_plus(4.58353464850448, 6.24337428083998, 2.02175251950524, {4.08601582896563, 1.02342168432715, -2.64617549209675, -3.57180258929208, 3.48973425458432, 0.222099376698658, -2.43215804300781, 4.41077314080077, -0.713254801810997}), 0.0165828595039153, eps);
                TEST_CHECK_NEARLY_EQUAL(B_phi_plus(3.64836643626869, 5.15348261315131, 1.72611683207198, {-0.714240960391399, -2.15797932375586, 0.571209449442506, -1.22820590802695, 0.244023175014942, -4.24810566380508, -4.09847169018875, 4.18576247505146, 3.44114890343812}), -0.0367810953402926, eps);
            }
            {
                static const double eps = 1e-3; // Bad convergence of the numerical reference
                TEST_CHECK_NEARLY_EQUAL(L0_Dphi_plus_eff_1(3.0027029738103, 1.99960590974565, 6.37812403407912, {3.37345025452524, 2.98096488452424, 4.12619290292696, -1.19128261574059, -0.0486579671797358, -3.47239380649231, 4.53109988311051, -3.88674807441639, -0.580181149764274}), 3.80076363570726, eps);
                TEST_CHECK_NEARLY_EQUAL(L0_Dphi_plus_eff_1(2.63859779030775, 3.1020474404051, 7.68683033052426, {1.77587861002867, 2.06272998577698, -2.05336768866077, -1.39351737750169, -0.910349084636778, -3.16749259700458, -1.67854742217326, -3.43423470159169, 2.69942566623036}), 0.0184953896283472, eps);
                TEST_CHECK_NEARLY_EQUAL(L0_Dphi_plus_eff_1(3.17879893849292, 1.32624040871845, 6.67398894683204, {2.60412046060825, 4.42521764835355, 4.51794973332385, 3.50115158934325, 3.89586912531994, 4.98390060648519, -0.357364301882168, 1.69200290786422, 0.700466002845667}), -1.8206959735755, eps);
                TEST_CHECK_NEARLY_EQUAL(L0_Dphi_plus_eff_1(1.89599746576058, 0.672815022172912, 5.26668103492566, {1.15772930723382, -3.50571322347419, -0.74507042900941, 1.36038528642577, -2.14179786211229, -4.28255692285, 2.62483460958203, 3.39582946447164, -3.28185305287786}), 4.13923111452122, eps);
                TEST_CHECK_NEARLY_EQUAL(L0_Dphi_plus_eff_1(2.57683446571122, 3.92449052578594, 6.52498607382163, {-3.94593156676529, -0.645807127201653, -0.366827537203875, 3.01174581618581, 0.0280626976589016, -3.01047406992245, 2.51733748036837, -4.14847518257591, -4.8242284191552}), 0.299545586169794, eps);
                TEST_CHECK_NEARLY_EQUAL(L0_Dphi_plus_eff_1(1.83263766254612, 0.454205643288678, 5.86636514411272, {-0.961323971346566, -0.396743897718091, -2.5688623820069, -3.42084224292613, 1.28807237550245, -0.175050834594039, -1.73232948271898, 0.0511971633600936, 4.65174910634408}), 0.641915014410297, eps);
            }
        }
} b_lcdas_param_test;
